import{S as w,i as U,s as O,C as te,k as g,a as $,q as M,l as A,m as I,c as D,r as T,h as u,n as m,b as N,G as _,D as se,E as le,F as ne,u as L,f as d,t as S,w as H,x as P,y as V,z as y,K as q,g as k,d as G,H as ee,e as C,T as re,I as ie,o as oe,J as z}from"../../../chunks/index-e8ce05bb.js";import{p as ae}from"../../../chunks/stores-cff3d914.js";import{D as W,u as B,g as K,c as ce,b as ue}from"../../../chunks/store-c06ff3d7.js";import{L as fe}from"../../../chunks/Link-b437056b.js";class _e extends Error{constructor(){super("Could not make an API request to the Discord server, because authorization token is missing or is invalid")}}class de extends Error{constructor(){super("Could not make an API request to the Discord server, because you are being rate limited")}}class he{constructor(s){this.token=s}async fetch(s){const n=await fetch(s,{headers:{authorization:this.token}});if(n.status==401)throw _e;if(n.status==429)throw de;return n}async fetchUser(){return(await this.fetch(`${W}/users/@me`)).json()}async fetchGuilds(){return(await this.fetch(`${W}/users/@me/guilds`)).json()}async updateUserCache(){B.set(await this.fetchUser())}async updateGuildsCache(){K.set(await this.fetchGuilds())}}const R={CREATE_INSTANT_INVITE:1,KICK_MEMBERS:2,BAN_MEMBERS:4,ADMINISTRATOR:8,MANAGE_CHANNELS:16,MANAGE_GUILD:32,ADD_REACTIONS:64,VIEW_AUDIT_LOG:128,PRIORITY_SPEAKER:256,STREAM:512,VIEW_CHANNEL:1024,SEND_MESSAGES:2048,SEND_TTS_MESSAGES:4096,MANAGE_MESSAGES:8192,EMBED_LINKS:16384,ATTACH_FILES:32768,READ_MESSAGE_HISTORY:65536,MENTION_EVERYONE:131072,USE_EXTERNAL_EMOJIS:262144,VIEW_GUILD_INSIGHTS:524288,CONNECT:1048576,SPEAK:2097152,MUTE_MEMBERS:4194304,DEAFEN_MEMBERS:8388608,MOVE_MEMBERS:16777216,USE_VAD:33554432,CHANGE_NICKNAME:67108864,MANAGE_NICKNAMES:134217728,MANAGE_ROLES:268435456,MANAGE_WEBHOOKS:536870912,MANAGE_EMOJIS_AND_STICKERS:1073741824,USE_APPLICATION_COMMANDS:34359738368,REQUEST_TO_SPEAK:4294967296,MANAGE_THREADS:17179869184,USE_PUBLIC_THREADS:34359738368,USE_PRIVATE_THREADS:68719476736,USE_EXTERNAL_STICKERS:137438953472},pe=o=>{let s=[];o=Number(o);const n=Math.floor(o/4294967296),e=Math.floor(o%4294967296);for(const t in R)if(R[t]>=4294967296&&n&Math.floor(R[t]/4294967296)||R[t]<4294967296&&e&R[t])s.push(t);else continue;return s};function me(o){let s,n,e,t,l;const r=o[4].default,a=te(r,o,o[3],null);return{c(){s=g("div"),a&&a.c(),n=$(),e=g("div"),t=M(o[0]),this.h()},l(i){s=A(i,"DIV",{class:!0});var c=I(s);a&&a.l(c),n=D(c),e=A(c,"DIV",{class:!0});var E=I(e);t=T(E,o[0]),E.forEach(u),c.forEach(u),this.h()},h(){m(e,"class","tooltip group-hover:scale-100 "+o[1]+" svelte-1ica9i0"),m(s,"class","tooltip-box group svelte-1ica9i0")},m(i,c){N(i,s,c),a&&a.m(s,null),_(s,n),_(s,e),_(e,t),l=!0},p(i,[c]){a&&a.p&&(!l||c&8)&&se(a,r,i,i[3],l?ne(r,i[3],c,null):le(i[3]),null),(!l||c&1)&&L(t,i[0])},i(i){l||(d(a,i),l=!0)},o(i){S(a,i),l=!1},d(i){i&&u(s),a&&a.d(i)}}}function Ee(o,s,n){let{$$slots:e={},$$scope:t}=s,{text:l}=s,{position:r="top"}=s;const i={top:"-mt-16",left:"",right:"",bottom:""}[r];return o.$$set=c=>{"text"in c&&n(0,l=c.text),"position"in c&&n(2,r=c.position),"$$scope"in c&&n(3,t=c.$$scope)},[l,i,r,t,e]}class ge extends w{constructor(s){super(),U(this,s,Ee,me,O,{text:0,position:2})}}function Ae(o){let s,n;return{c(){s=g("p"),n=M(o[2])},l(e){s=A(e,"P",{});var t=I(s);n=T(t,o[2]),t.forEach(u)},m(e,t){N(e,s,t),_(s,n)},p(e,t){t&4&&L(n,e[2])},d(e){e&&u(s)}}}function Se(o){let s,n,e,t,l,r,a,i,c=o[0].id+"",E,h;return r=new ge({props:{position:"top",text:o[0].name,$$slots:{default:[Ae]},$$scope:{ctx:o}}}),{c(){s=g("div"),n=g("img"),t=$(),l=g("div"),H(r.$$.fragment),a=$(),i=g("p"),E=M(c),this.h()},l(f){s=A(f,"DIV",{class:!0});var p=I(s);n=A(p,"IMG",{class:!0,src:!0,alt:!0}),t=D(p),l=A(p,"DIV",{class:!0});var v=I(l);P(r.$$.fragment,v),a=D(v),i=A(v,"P",{class:!0});var b=I(i);E=T(b,c),b.forEach(u),v.forEach(u),p.forEach(u),this.h()},h(){m(n,"class","rounded-xl w-10 h-10"),q(n.src,e=o[1])||m(n,"src",e),m(n,"alt","guild icon"),m(i,"class","text-[#60626D] font-medium text-sm"),m(l,"class","flex flex-col"),m(s,"class","text-white select-none text-ellipsis w-60 p-4 rounded-xl items-center gap-3 bg-[#282930] flex flex-row")},m(f,p){N(f,s,p),_(s,n),_(s,t),_(s,l),V(r,l,null),_(l,a),_(l,i),_(i,E),h=!0},p(f,p){(!h||p&2&&!q(n.src,e=f[1]))&&m(n,"src",e);const v={};p&1&&(v.text=f[0].name),p&12&&(v.$$scope={dirty:p,ctx:f}),r.$set(v),(!h||p&1)&&c!==(c=f[0].id+"")&&L(E,c)},i(f){h||(d(r.$$.fragment,f),h=!0)},o(f){S(r.$$.fragment,f),h=!1},d(f){f&&u(s),y(r)}}}function Ie(o){let s,n;return s=new fe({props:{href:"/dashboard/"+o[0].id,$$slots:{default:[Se]},$$scope:{ctx:o}}}),{c(){H(s.$$.fragment)},l(e){P(s.$$.fragment,e)},m(e,t){V(s,e,t),n=!0},p(e,[t]){const l={};t&1&&(l.href="/dashboard/"+e[0].id),t&15&&(l.$$scope={dirty:t,ctx:e}),s.$set(l)},i(e){n||(d(s.$$.fragment,e),n=!0)},o(e){S(s.$$.fragment,e),n=!1},d(e){y(s,e)}}}function ve(o,s,n){let{guild:e}=s,t=`https://cdn.discordapp.com/icons/${e.id}/${e.icon}.webp?size=40`,l=e.name;return e.icon==null&&(t=`${ce}/assets/discord.png`),o.$$set=r=>{"guild"in r&&n(0,e=r.guild)},o.$$.update=()=>{o.$$.dirty&1&&e.name.length>=18&&n(2,l=e.name.slice(0,14)+"...")},[e,t,l]}class Ne extends w{constructor(s){super(),U(this,s,ve,Ie,O,{guild:0})}}function j(o,s,n){const e=o.slice();return e[3]=s[n],e[5]=n,e}function J(o,s,n){const e=o.slice();return e[3]=s[n],e[7]=n,e}function Y(o){let s,n,e,t=Array(o[0]),l=[];for(let a=0;a<t.length;a+=1)l[a]=Q(J(o,t,a));const r=a=>S(l[a],1,1,()=>{l[a]=null});return{c(){s=g("div");for(let a=0;a<l.length;a+=1)l[a].c();n=$(),this.h()},l(a){s=A(a,"DIV",{class:!0});var i=I(s);for(let c=0;c<l.length;c+=1)l[c].l(i);n=D(i),i.forEach(u),this.h()},h(){m(s,"class","flex flex-row gap-2")},m(a,i){N(a,s,i);for(let c=0;c<l.length;c+=1)l[c].m(s,null);_(s,n),e=!0},p(a,i){if(i&3){t=Array(a[0]);let c;for(c=0;c<t.length;c+=1){const E=J(a,t,c);l[c]?(l[c].p(E,i),d(l[c],1)):(l[c]=Q(E),l[c].c(),d(l[c],1),l[c].m(s,n))}for(k(),c=t.length;c<l.length;c+=1)r(c);G()}},i(a){if(!e){for(let i=0;i<t.length;i+=1)d(l[i]);e=!0}},o(a){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)S(l[i]);e=!1},d(a){a&&u(s),ee(l,a)}}}function X(o){let s,n;return s=new Ne({props:{guild:o[1][o[5]/o[0]*o[0]+o[7]]}}),{c(){H(s.$$.fragment)},l(e){P(s.$$.fragment,e)},m(e,t){V(s,e,t),n=!0},p(e,t){const l={};t&1&&(l.guild=e[1][e[5]/e[0]*e[0]+e[7]]),s.$set(l)},i(e){n||(d(s.$$.fragment,e),n=!0)},o(e){S(s.$$.fragment,e),n=!1},d(e){y(s,e)}}}function Q(o){let s,n,e=o[1][o[5]/o[0]*o[0]+o[7]]&&X(o);return{c(){e&&e.c(),s=C()},l(t){e&&e.l(t),s=C()},m(t,l){e&&e.m(t,l),N(t,s,l),n=!0},p(t,l){t[1][t[5]/t[0]*t[0]+t[7]]?e?(e.p(t,l),l&1&&d(e,1)):(e=X(t),e.c(),d(e,1),e.m(s.parentNode,s)):e&&(k(),S(e,1,1,()=>{e=null}),G())},i(t){n||(d(e),n=!0)},o(t){S(e),n=!1},d(t){e&&e.d(t),t&&u(s)}}}function F(o){let s,n,e=o[5]%o[0]===0&&Y(o);return{c(){e&&e.c(),s=C()},l(t){e&&e.l(t),s=C()},m(t,l){e&&e.m(t,l),N(t,s,l),n=!0},p(t,l){t[5]%t[0]===0?e?(e.p(t,l),l&1&&d(e,1)):(e=Y(t),e.c(),d(e,1),e.m(s.parentNode,s)):e&&(k(),S(e,1,1,()=>{e=null}),G())},i(t){n||(d(e),n=!0)},o(t){S(e),n=!1},d(t){e&&e.d(t),t&&u(s)}}}function Me(o){let s,n,e=o[1],t=[];for(let r=0;r<e.length;r+=1)t[r]=F(j(o,e,r));const l=r=>S(t[r],1,1,()=>{t[r]=null});return{c(){s=g("div");for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){s=A(r,"DIV",{class:!0});var a=I(s);for(let i=0;i<t.length;i+=1)t[i].l(a);a.forEach(u),this.h()},h(){m(s,"class","flex flex-col gap-2")},m(r,a){N(r,s,a);for(let i=0;i<t.length;i+=1)t[i].m(s,null);n=!0},p(r,[a]){if(a&3){e=r[1];let i;for(i=0;i<e.length;i+=1){const c=j(r,e,i);t[i]?(t[i].p(c,a),d(t[i],1)):(t[i]=F(c),t[i].c(),d(t[i],1),t[i].m(s,null))}for(k(),i=e.length;i<t.length;i+=1)l(i);G()}},i(r){if(!n){for(let a=0;a<e.length;a+=1)d(t[a]);n=!0}},o(r){t=t.filter(Boolean);for(let a=0;a<t.length;a+=1)S(t[a]);n=!1},d(r){r&&u(s),ee(t,r)}}}function Te(o,s,n){let{guilds:e}=s,{columns:t=4}=s,l=[];return o.$$set=r=>{"guilds"in r&&n(2,e=r.guilds),"columns"in r&&n(0,t=r.columns)},o.$$.update=()=>{o.$$.dirty&4&&e.forEach(r=>{pe(r.permissions).includes("ADMINISTRATOR")&&l.push(r)})},[t,l,e]}class $e extends w{constructor(s){super(),U(this,s,Te,Me,O,{guilds:2,columns:0})}}function Z(o){let s,n,e,t=o[0]!=null&&x(o);return n=new $e({props:{guilds:o[1]}}),{c(){t&&t.c(),s=$(),H(n.$$.fragment)},l(l){t&&t.l(l),s=D(l),P(n.$$.fragment,l)},m(l,r){t&&t.m(l,r),N(l,s,r),V(n,l,r),e=!0},p(l,r){l[0]!=null?t?t.p(l,r):(t=x(l),t.c(),t.m(s.parentNode,s)):t&&(t.d(1),t=null);const a={};r&2&&(a.guilds=l[1]),n.$set(a)},i(l){e||(d(n.$$.fragment,l),e=!0)},o(l){S(n.$$.fragment,l),e=!1},d(l){t&&t.d(l),l&&u(s),y(n,l)}}}function x(o){let s,n,e,t,l=o[0].username+"",r,a,i,c,E;return{c(){s=g("div"),n=g("h1"),e=M("Hey, "),t=g("span"),r=M(l),a=M("!"),i=$(),c=g("p"),E=M("Select a guild to continue"),this.h()},l(h){s=A(h,"DIV",{class:!0});var f=I(s);n=A(f,"H1",{class:!0});var p=I(n);e=T(p,"Hey, "),t=A(p,"SPAN",{class:!0});var v=I(t);r=T(v,l),v.forEach(u),a=T(p,"!"),p.forEach(u),i=D(f),c=A(f,"P",{});var b=I(c);E=T(b,"Select a guild to continue"),b.forEach(u),f.forEach(u),this.h()},h(){m(t,"class","text-indigo-500"),m(n,"class","text-white text-4xl"),m(s,"class","flex flex-col gap-4 text-white items-center")},m(h,f){N(h,s,f),_(s,n),_(n,e),_(n,t),_(t,r),_(n,a),_(s,i),_(s,c),_(c,E)},p(h,f){f&1&&l!==(l=h[0].username+"")&&L(r,l)},d(h){h&&u(s)}}}function De(o){let s,n,e,t,l=o[1]!=null&&Z(o);return{c(){s=g("meta"),n=$(),e=g("div"),l&&l.c(),this.h()},l(r){const a=re("svelte-bmju4y",document.head);s=A(a,"META",{name:!0,content:!0}),a.forEach(u),n=D(r),e=A(r,"DIV",{class:!0});var i=I(e);l&&l.l(i),i.forEach(u),this.h()},h(){document.title="Dashboard",m(s,"name","description"),m(s,"content","Walty"),m(e,"class","relative w-full justify-center top-[50px] flex flex-col items-center gap-8")},m(r,a){_(document.head,s),N(r,n,a),N(r,e,a),l&&l.m(e,null),t=!0},p(r,[a]){r[1]!=null?l?(l.p(r,a),a&2&&d(l,1)):(l=Z(r),l.c(),d(l,1),l.m(e,null)):l&&(k(),S(l,1,1,()=>{l=null}),G())},i(r){t||(d(l),t=!0)},o(r){S(l),t=!1},d(r){u(s),r&&u(n),r&&u(e),l&&l.d()}}}function be(o,s,n){let e,t,l,r;ie(o,ae,i=>n(3,r=i));const a=!1;return K.subscribe(i=>{n(1,e=i)}),B.subscribe(i=>{n(0,t=i)}),oe(async()=>{l.OAUTH_2==null&&location.assign(ue);const{token_type:i,access_token:c}=l.OAUTH_2,E=`${i} ${c}`,h=new he(E);await h.updateUserCache(),await h.updateGuildsCache()}),o.$$.update=()=>{o.$$.dirty&8&&(l=r.data.session)},n(1,e=z(K)),n(0,t=z(B)),[t,e,a,r]}class we extends w{constructor(s){super(),U(this,s,be,De,O,{prerender:2})}get prerender(){return this.$$.ctx[2]}}export{we as default};
